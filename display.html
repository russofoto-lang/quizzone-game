<!DOCTYPE html>
<html lang="it">
<head>
    <!-- ... HEADER EXISTING CODE ... -->
</head>
<body class="flex flex-col h-screen p-2 sm:p-4">
    <!-- ... EXISTING HTML CODE ... -->

    <!-- VISTA LOGO/QR (esistente) -->
    <div id="view-logo" class="view-section absolute inset-0 flex flex-col items-center justify-center">
        <!-- ... -->
    </div>

    <!-- VISTA GIOCO (esistente) -->
    <div id="view-gioco" class="view-section hidden absolute inset-0 flex flex-col items-center justify-center p-2">
        <!-- ... -->
    </div>

    <!-- VISTA CLASSIFICA ROUND (esistente) -->
    <div id="view-classifica_round" class="view-section hidden absolute inset-0 bg-indigo-950 z-40 flex flex-col items-center p-2 sm:p-4 overflow-hidden">
        <!-- ... -->
    </div>

    <!-- VISTA CLASSIFICA GENERALE (esistente) -->
    <div id="view-classifica_gen" class="view-section hidden absolute inset-0 bg-slate-900 z-40 flex flex-col items-center p-2 sm:p-4 overflow-hidden">
        <!-- ... -->
    </div>

    <!-- VISTA VINCITORE FESTOSA (NUOVA - AGGIUNGI QUESTA) -->
    <div id="view-vincitore" class="view-section hidden absolute inset-0 z-50 flex flex-col items-center justify-center p-4">
        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400 via-red-500 to-purple-600 animate-pulse"></div>
        
        <div class="relative z-10 text-center max-w-4xl w-full">
            <!-- Fuochi d'artificio animati -->
            <div class="absolute top-0 left-0 w-20 h-20 animate-bounce">
                <div class="text-5xl">üéÜ</div>
            </div>
            <div class="absolute top-0 right-0 w-20 h-20 animate-bounce" style="animation-delay: 0.2s">
                <div class="text-5xl">üéá</div>
            </div>
            <div class="absolute bottom-0 left-0 w-20 h-20 animate-bounce" style="animation-delay: 0.4s">
                <div class="text-5xl">‚ú®</div>
            </div>
            <div class="absolute bottom-0 right-0 w-20 h-20 animate-bounce" style="animation-delay: 0.6s">
                <div class="text-5xl">üéâ</div>
            </div>
            
            <!-- Contenitore principale -->
            <div class="glass bg-white/20 backdrop-blur-xl rounded-3xl p-8 sm:p-12 border-8 border-yellow-300 shadow-2xl">
                <!-- Corona sopra il titolo -->
                <div class="flex justify-center mb-6">
                    <div class="text-6xl animate-bounce">üëë</div>
                </div>
                
                <!-- Titolo principale -->
                <h1 class="text-4xl sm:text-6xl font-black mb-8 text-white uppercase tracking-wider animate__animated animate__rubberBand">
                    üèÜ VINCITORE ASSOLUTO üèÜ
                </h1>
                
                <!-- Nome squadra vincitrice -->
                <div id="winner-team-name" class="text-5xl sm:text-7xl font-black mb-8 text-yellow-300 bg-black/30 p-6 rounded-2xl border-4 border-yellow-500 shadow-lg animate__animated animate__pulse animate__infinite">
                    CARICAMENTO...
                </div>
                
                <!-- Punteggio -->
                <div class="text-3xl sm:text-4xl font-bold text-white mb-10">
                    Punteggio: <span id="winner-score" class="text-yellow-300 text-4xl sm:text-5xl">0</span> punti
                </div>
                
                <!-- Classifica finale -->
                <div class="mt-10 p-6 bg-black/40 rounded-2xl">
                    <h2 class="text-2xl sm:text-3xl font-bold text-white mb-4">üèÖ CLASSIFICA FINALE</h2>
                    <div id="final-ranking" class="space-y-3 text-left">
                        <!-- Popolato via JS -->
                    </div>
                </div>
                
                <!-- Messaggio finale -->
                <div class="mt-10 text-xl text-white/90 italic">
                    Grazie per aver giocato con SIPONTO FOREVER YOUNG!
                </div>
            </div>
        </div>
    </div>

</div> <!-- Questo chiude il div con class="h-[92%] relative flex..." -->

    <script>
        const socket = io();
        let timerInterval = null;
        let questionStartTime = 0;
        let maxTime = 20;
        
        function showView(id) {
            // Nascondi tutte le viste
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            
            // Mostra la vista richiesta
            const viewId = 'view-' + id;
            const el = document.getElementById(viewId);
            if(el) {
                el.classList.remove('hidden');
                console.log('Mostro vista:', viewId);
            } else {
                console.error('Vista non trovata:', viewId);
            }
        }

        // ... TUTTO IL CODICE JAVASCRIPT ESISTENTE ...

        // Aggiungi queste nuove funzioni dopo le funzioni esistenti:

        // Funzione per mostrare la schermata del vincitore
        function mostraVincitore(vincitore, classificaCompleta) {
            showView('vincitore');
            
            // Mostra nome squadra vincitrice
            document.getElementById('winner-team-name').innerText = vincitore.name;
            document.getElementById('winner-score').innerText = vincitore.score;
            
            // Mostra classifica completa
            const rankingDiv = document.getElementById('final-ranking');
            rankingDiv.innerHTML = '';
            
            classificaCompleta.forEach((team, index) => {
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                const medal = medals[index] || `#${index + 1}`;
                const isWinner = index === 0;
                
                rankingDiv.innerHTML += `
                    <div class="flex justify-between items-center p-3 ${isWinner ? 'bg-yellow-500/30 rounded-xl' : ''}">
                        <div class="flex items-center gap-3">
                            <span class="text-2xl font-bold">${medal}</span>
                            <span class="text-xl font-bold ${isWinner ? 'text-yellow-300' : 'text-white'}">${team.name}</span>
                        </div>
                        <span class="text-2xl font-black ${isWinner ? 'text-yellow-300' : 'text-gray-300'}">${team.score}</span>
                    </div>
                `;
            });
            
            // Animazioni extra
            setTimeout(() => {
                document.getElementById('winner-team-name').classList.add('animate__tada');
            }, 1000);
        }

        // Aggiungi questo handler per il socket DOPO gli altri handler:
        socket.on('mostra_vincitore', (data) => {
            console.log('Ricevuto comando per mostrare vincitore:', data);
            mostraVincitore(data.vincitore, data.classifica);
        });

        // ... RESTO DEL CODICE JAVASCRIPT ESISTENTE ...

        socket.on('update_teams', (teams) => {
            teams.sort((a,b) => b.score - a.score);
            // ... codice esistente per update_teams ...
        });

        socket.on('reset_buzzer', () => { /* codice esistente */ });
    </script>
</body>
</html>
